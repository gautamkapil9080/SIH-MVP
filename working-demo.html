<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE-D Telemedicine - Rural Healthcare Access</title>
    <!-- Updated: 2025-01-15 13:28 - Patient Portal with Registration & Login -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .navbar {
            background: #2E8B57;
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-brand h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .nav-links button {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .nav-links button:hover, .nav-links button.active {
            background: rgba(255,255,255,0.3);
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .language-selector select {
            padding: 5px;
            border-radius: 4px;
        }

        .section {
            display: none;
            padding: 2rem;
            min-height: 80vh;
        }

        .section.active {
            display: block;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .btn {
            background: #2E8B57;
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn:hover {
            background: #236B43;
        }

        .emergency-btn {
            background: #dc3545;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .symptoms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .symptom-btn {
            padding: 1rem;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }

        .symptom-btn.selected {
            border-color: #2E8B57;
            background: #e8f5e8;
        }

        .medicine-result {
            background: #f8f9fa;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 4px;
            border-left: 4px solid #2E8B57;
        }

        .status-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 4px;
            display: none;
            z-index: 1001;
        }

        .status-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Patient Portal Tabs */
        .patient-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e9ecef;
        }

        .patient-tab-btn {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-size: 1rem;
            color: #6c757d;
            transition: all 0.3s;
        }

        .patient-tab-btn.active {
            color: #2E8B57;
            border-bottom-color: #2E8B57;
            font-weight: bold;
        }

        .patient-tab-btn:hover {
            color: #2E8B57;
            background: rgba(46, 139, 87, 0.1);
        }

        .patient-tab-content {
            display: none;
        }

        .patient-tab-content.active {
            display: block;
        }

        /* Enhanced Form Styling */
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .medical-info-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border: 1px solid #dee2e6;
        }

        .medical-info-section h4 {
            color: #2E8B57;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .patient-profile {
            background: #e8f5e8;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #2E8B57;
        }

        .patient-profile h3 {
            color: #2E8B57;
            margin-bottom: 1rem;
        }

        .profile-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .profile-item {
            background: white;
            padding: 0.75rem;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }

        .profile-item strong {
            color: #2E8B57;
            display: block;
            margin-bottom: 0.25rem;
        }

        /* AI Chatbot Styles */
        .chatbot-container {
            max-height: 500px;
            overflow-y: auto;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 1rem;
            background: #f8f9fa;
            margin: 1rem 0;
        }

        .chat-message {
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
        }

        .chat-message.ai {
            justify-content: flex-start;
        }

        .chat-message.user {
            justify-content: flex-end;
        }

        .message-bubble {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: 15px;
            word-wrap: break-word;
        }

        .message-bubble.ai {
            background: #2E8B57;
            color: white;
            border-bottom-left-radius: 5px;
        }

        .message-bubble.user {
            background: #007bff;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin: 0 0.5rem;
        }

        .ai-avatar {
            background: #2E8B57;
            color: white;
        }

        .user-avatar {
            background: #007bff;
            color: white;
        }

        .chat-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
            justify-content: center;
        }

        .chat-option {
            background: #e9ecef;
            border: 2px solid #dee2e6;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .chat-option:hover {
            background: #2E8B57;
            color: white;
            border-color: #2E8B57;
        }

        .voice-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .voice-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
        }

        .voice-btn:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .voice-btn.recording {
            background: #dc3545;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .typing-indicator {
            display: none;
            align-items: center;
            padding: 0.5rem 1rem;
            color: #6c757d;
            font-style: italic;
        }

        .typing-dots {
            display: inline-block;
            margin-left: 0.5rem;
        }

        .typing-dots span {
            animation: typing 1.4s infinite;
            display: inline-block;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; }
            30% { opacity: 1; }
        }

        .diagnosis-result {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border: 2px solid #2E8B57;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .urgency-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }

        .urgency-mild {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .urgency-urgent {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .urgency-emergency {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
            }
            
            .section {
                padding: 1rem;
            }

            .patient-tabs {
                flex-direction: column;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }

            .form-row .form-group {
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="language-selector">
        <select id="languageSelect">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)</option>
            <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)</option>
        </select>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <h1 id="app_title">CSE-D Telemedicine</h1>
        </div>
        <div class="nav-links">
            <button onclick="showSection('patient')" id="patient_portal" class="active">Patient Portal</button>
            <button onclick="showSection('doctor')" id="doctor_portal">Doctor Portal</button>
            <button onclick="showSection('pharmacy')" id="pharmacy_portal">Pharmacy Portal</button>
            <button onclick="showSection('symptoms')" id="symptom_checker">Symptom Checker</button>
            <button onclick="showSection('schemes')" id="gov_schemes">Govt Schemes</button>
            <button onclick="showSection('emergency')" id="emergency" class="emergency-btn">üö® Emergency</button>
        </div>
    </nav>

    <!-- Patient Section -->
    <section id="patient-section" class="section active">
        <div class="container">
            <h2 id="patient_portal_title">Patient Portal</h2>
            
            <!-- Patient Portal Tabs - Updated for Login/Registration -->
            <div class="patient-tabs" style="border: 2px solid #2E8B57; padding: 10px; margin: 10px 0;">
                <button onclick="showPatientTab('registration')" class="patient-tab-btn active" id="tab_registration">üìù Registration</button>
                <button onclick="showPatientTab('login')" class="patient-tab-btn" id="tab_login">üîë Login</button>
            </div>
            <p style="color: #2E8B57; font-size: 0.9em; margin: 5px 0;">‚úÖ Patient Portal now has both Registration and Login tabs above!</p>

            <!-- Registration Tab -->
            <div id="registration-tab" class="patient-tab-content active">
                <div class="card">
                    <h3 id="patient_registration">Patient Registration</h3>
                    <form id="patientRegistrationForm">
                        <!-- Basic Information -->
                        <h4 id="basic_info">üìã Basic Information</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label id="full_name">Full Name:</label>
                                <input type="text" id="regPatientName" required>
                            </div>
                            <div class="form-group">
                                <label id="age">Age:</label>
                                <input type="number" id="regPatientAge" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label id="phone">Phone Number:</label>
                                <input type="tel" id="regPatientPhone" required>
                            </div>
                            <div class="form-group">
                                <label id="gender">Gender:</label>
                                <select id="regPatientGender" required>
                                    <option value="" id="select_gender">Select Gender</option>
                                    <option value="male" id="male">Male</option>
                                    <option value="female" id="female">Female</option>
                                    <option value="other" id="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label id="village">Village/Address:</label>
                                <input type="text" id="regPatientVillage" required>
                            </div>
                            <div class="form-group">
                                <label id="password">Password:</label>
                                <input type="password" id="regPatientPassword" required>
                            </div>
                        </div>

                        <!-- Medical Information -->
                        <div class="medical-info-section">
                            <h4 id="medical_info">ü©∫ Medical Information</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="blood_group">Blood Group:</label>
                                    <select id="regBloodGroup" required>
                                        <option value="" id="select_blood_group">Select Blood Group</option>
                                        <option value="A+">A+</option>
                                        <option value="A-">A-</option>
                                        <option value="B+">B+</option>
                                        <option value="B-">B-</option>
                                        <option value="AB+">AB+</option>
                                        <option value="AB-">AB-</option>
                                        <option value="O+">O+</option>
                                        <option value="O-">O-</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label id="height">Height (cm):</label>
                                    <input type="number" id="regHeight" placeholder="e.g., 170">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="weight">Weight (kg):</label>
                                    <input type="number" id="regWeight" placeholder="e.g., 65">
                                </div>
                                <div class="form-group">
                                    <label id="sugar_level">Sugar Level (mg/dL):</label>
                                    <input type="number" id="regSugarLevel" placeholder="e.g., 110">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="blood_pressure_systolic">Blood Pressure (Systolic):</label>
                                    <input type="number" id="regBPSystolic" placeholder="e.g., 120">
                                </div>
                                <div class="form-group">
                                    <label id="blood_pressure_diastolic">Blood Pressure (Diastolic):</label>
                                    <input type="number" id="regBPDiastolic" placeholder="e.g., 80">
                                </div>
                            </div>
                        </div>

                        <!-- Medical History -->
                        <div class="form-group">
                            <label id="medical_history">Medical History:</label>
                            <textarea id="regMedicalHistory" rows="3" placeholder="Previous surgeries, chronic conditions, allergies, etc."></textarea>
                        </div>
                        
                        <!-- Current Symptoms -->
                        <div class="form-group">
                            <label id="current_symptoms">Current Symptoms:</label>
                            <textarea id="regCurrentSymptoms" rows="3" placeholder="Describe your current health concerns..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label id="urgency">Urgency Level:</label>
                            <select id="regUrgencyLevel">
                                <option value="low" id="low">Low</option>
                                <option value="medium" id="medium">Medium</option>
                                <option value="high" id="high">High</option>
                                <option value="emergency" id="emergency_level">Emergency</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn" id="register_btn">Register & Submit Request</button>
                    </form>
                </div>
            </div>

            <!-- Login Tab -->
            <div id="login-tab" class="patient-tab-content">
                <div class="card">
                    <h3 id="patient_login">Patient Login</h3>
                    <form id="patientLoginForm">
                        <div class="form-group">
                            <label id="login_phone">Phone Number:</label>
                            <input type="tel" id="loginPhone" required>
                        </div>
                        <div class="form-group">
                            <label id="login_password">Password:</label>
                            <input type="password" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn" id="login_btn">Login</button>
                    </form>
                </div>
                
                <!-- Patient Profile (shown after login) -->
                <div id="patientProfile" class="patient-profile" style="display: none;">
                    <h3 id="patient_profile_title">üë§ Patient Profile</h3>
                    <div class="profile-info">
                        <div class="profile-item">
                            <strong id="profile_name_label">Name:</strong>
                            <span id="profileName">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_age_label">Age:</strong>
                            <span id="profileAge">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_gender_label">Gender:</strong>
                            <span id="profileGender">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_phone_label">Phone:</strong>
                            <span id="profilePhone">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_blood_group_label">Blood Group:</strong>
                            <span id="profileBloodGroup">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_village_label">Address:</strong>
                            <span id="profileVillage">-</span>
                        </div>
                    </div>
                    
                    <h4 id="medical_info_title" style="margin: 1.5rem 0 1rem 0; color: #2E8B57;">ü©∫ Medical Information</h4>
                    <div class="profile-info">
                        <div class="profile-item">
                            <strong id="profile_height_label">Height:</strong>
                            <span id="profileHeight">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_weight_label">Weight:</strong>
                            <span id="profileWeight">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_sugar_label">Sugar Level:</strong>
                            <span id="profileSugar">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="profile_bp_label">Blood Pressure:</strong>
                            <span id="profileBP">-</span>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <strong id="profile_history_label">Medical History:</strong>
                        <p id="profileMedicalHistory" style="margin: 0.5rem 0; padding: 1rem; background: white; border-radius: 4px;">-</p>
                    </div>
                    
                    <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                        <button onclick="requestConsultation()" class="btn" id="request_consultation_btn">Request New Consultation</button>
                        <button onclick="logoutPatient()" class="btn" style="background: #6c757d;" id="logout_btn">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Doctor Section -->
    <section id="doctor-section" class="section">
        <div class="container">
            <h2 id="doctor_portal_title">Doctor Portal</h2>
            
            <!-- Doctor Portal Tabs -->
            <div class="patient-tabs" style="border: 2px solid #2E8B57; padding: 10px; margin: 10px 0;">
                <button onclick="showDoctorTab('registration')" class="patient-tab-btn active" id="doctor_tab_registration">üìù Doctor Registration</button>
                <button onclick="showDoctorTab('login')" class="patient-tab-btn" id="doctor_tab_login">üîë Doctor Login</button>
            </div>
            <p style="color: #2E8B57; font-size: 0.9em; margin: 5px 0;">‚úÖ Doctor Portal now has both Registration and Login tabs above!</p>

            <!-- Doctor Registration Tab -->
            <div id="doctor-registration-tab" class="patient-tab-content active">
                <div class="card">
                    <h3 id="doctor_registration">Doctor Registration</h3>
                    <form id="doctorRegistrationForm">
                        <!-- Basic Information -->
                        <h4 id="doctor_basic_info">üìã Basic Information</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label id="doctor_full_name">Full Name:</label>
                                <input type="text" id="regDoctorName" required>
                            </div>
                            <div class="form-group">
                                <label id="doctor_phone">Phone Number:</label>
                                <input type="tel" id="regDoctorPhone" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label id="doctor_address">Address:</label>
                                <input type="text" id="regDoctorAddress" required>
                            </div>
                            <div class="form-group">
                                <label id="doctor_password">Password:</label>
                                <input type="password" id="regDoctorPassword" required>
                            </div>
                        </div>

                        <!-- Professional Information -->
                        <div class="medical-info-section">
                            <h4 id="doctor_professional_info">üéì Professional Information</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="doctor_qualification">Primary Qualification:</label>
                                    <select id="regDoctorQualification" required>
                                        <option value="" id="select_qualification">Select Qualification</option>
                                        <option value="MBBS">MBBS</option>
                                        <option value="MD">MD</option>
                                        <option value="MS">MS</option>
                                        <option value="DM">DM</option>
                                        <option value="MCh">MCh</option>
                                        <option value="BAMS">BAMS</option>
                                        <option value="BHMS">BHMS</option>
                                        <option value="BDS">BDS</option>
                                        <option value="MDS">MDS</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label id="doctor_specialization">Specialization:</label>
                                    <select id="regDoctorSpecialization" required>
                                        <option value="" id="select_specialization">Select Specialization</option>
                                        <option value="General Medicine">General Medicine</option>
                                        <option value="Pediatrics">Pediatrics</option>
                                        <option value="Cardiology">Cardiology</option>
                                        <option value="Dermatology">Dermatology</option>
                                        <option value="Gynecology">Gynecology</option>
                                        <option value="Orthopedics">Orthopedics</option>
                                        <option value="Psychiatry">Psychiatry</option>
                                        <option value="ENT">ENT</option>
                                        <option value="Ophthalmology">Ophthalmology</option>
                                        <option value="Neurology">Neurology</option>
                                        <option value="General Surgery">General Surgery</option>
                                        <option value="Anesthesiology">Anesthesiology</option>
                                        <option value="Radiology">Radiology</option>
                                        <option value="Pathology">Pathology</option>
                                        <option value="Family Medicine">Family Medicine</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="doctor_experience">Years of Experience:</label>
                                    <input type="number" id="regDoctorExperience" placeholder="e.g., 5" min="0" max="50">
                                </div>
                                <div class="form-group">
                                    <label id="doctor_license">Medical License Number:</label>
                                    <input type="text" id="regDoctorLicense" placeholder="e.g., MH12345">
                                </div>
                            </div>
                        </div>

                        <!-- Education Background -->
                        <div class="form-group">
                            <label id="doctor_education">Education Background:</label>
                            <textarea id="regDoctorEducation" rows="3" placeholder="Medical college, university, additional certifications, etc."></textarea>
                        </div>
                        
                        <!-- Current Practice -->
                        <div class="form-group">
                            <label id="doctor_current_practice">Current Practice/Hospital:</label>
                            <textarea id="regDoctorPractice" rows="2" placeholder="Current workplace, hospital affiliation, clinic details, etc."></textarea>
                        </div>
                        
                        <button type="submit" class="btn" id="doctor_register_btn">Register as Doctor</button>
                    </form>
                </div>
            </div>

            <!-- Doctor Login Tab -->
            <div id="doctor-login-tab" class="patient-tab-content">
                <div class="card">
                    <h3 id="doctor_login">Doctor Login</h3>
                    <form id="doctorLoginForm">
                        <div class="form-group">
                            <label id="doctor_login_phone">Phone Number:</label>
                            <input type="tel" id="loginDoctorPhone" required>
                        </div>
                        <div class="form-group">
                            <label id="doctor_login_password">Password:</label>
                            <input type="password" id="loginDoctorPassword" required>
                        </div>
                        <button type="submit" class="btn" id="doctor_login_btn">Login</button>
                    </form>
                </div>
                
                <!-- Doctor Profile (shown after login) -->
                <div id="doctorProfile" class="patient-profile" style="display: none;">
                    <h3 id="doctor_profile_title">üë®‚Äç‚öïÔ∏è Doctor Profile</h3>
                    <div class="profile-info">
                        <div class="profile-item">
                            <strong id="doctor_profile_name_label">Name:</strong>
                            <span id="doctorProfileName">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_phone_label">Phone:</strong>
                            <span id="doctorProfilePhone">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_address_label">Address:</strong>
                            <span id="doctorProfileAddress">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_qualification_label">Qualification:</strong>
                            <span id="doctorProfileQualification">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_specialization_label">Specialization:</strong>
                            <span id="doctorProfileSpecialization">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_experience_label">Experience:</strong>
                            <span id="doctorProfileExperience">-</span>
                        </div>
                        <div class="profile-item">
                            <strong id="doctor_profile_license_label">License:</strong>
                            <span id="doctorProfileLicense">-</span>
                        </div>
                    </div>
                    
                    <h4 id="doctor_education_title" style="margin: 1.5rem 0 1rem 0; color: #2E8B57;">üéì Education & Practice</h4>
                    <div style="margin-top: 1rem;">
                        <strong id="doctor_profile_education_label">Education Background:</strong>
                        <p id="doctorProfileEducation" style="margin: 0.5rem 0; padding: 1rem; background: white; border-radius: 4px;">-</p>
                    </div>
                    <div style="margin-top: 1rem;">
                        <strong id="doctor_profile_practice_label">Current Practice:</strong>
                        <p id="doctorProfilePractice" style="margin: 0.5rem 0; padding: 1rem; background: white; border-radius: 4px;">-</p>
                    </div>
                    
                    <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                        <button onclick="viewPendingRequests()" class="btn" id="view_requests_btn">View Patient Requests</button>
                        <button onclick="logoutDoctor()" class="btn" style="background: #6c757d;" id="doctor_logout_btn">Logout</button>
                    </div>
                </div>

                <!-- Pending Requests (shown after login) -->
                <div id="doctorDashboard" class="card" style="display: none; margin-top: 1rem;">
                    <h3 id="pending_requests">Pending Patient Requests</h3>
                    <div id="requestsList">
                        <div class="medicine-result">
                            <h4>Rajesh Kumar (45) - Khera Village</h4>
                            <p><strong>Symptoms:</strong> Fever and cough for 3 days</p>
                            <p><strong>Urgency:</strong> <span style="color: #dc3545;">High</span></p>
                            <p><strong>Time:</strong> 2 hours ago</p>
                            <button class="btn">Start Consultation</button>
                        </div>
                        <div class="medicine-result">
                            <h4>Priya Singh (32) - Dandian Village</h4>
                            <p><strong>Symptoms:</strong> Headache and nausea</p>
                            <p><strong>Urgency:</strong> <span style="color: #ffc107;">Medium</span></p>
                            <p><strong>Time:</strong> 1 hour ago</p>
                            <button class="btn">Start Consultation</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Pharmacy Section -->
    <section id="pharmacy-section" class="section">
        <div class="container">
            <h2 id="medicine_availability">Medicine Availability</h2>
            <div class="card">
                <h3 id="search_medicines">Search Medicines</h3>
                <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                    <input type="text" id="medicineSearch" placeholder="Enter medicine name" style="flex: 1;">
                    <button onclick="searchMedicine()" class="btn" id="search">Search</button>
                </div>
                <div id="medicineResults">
                    <div class="medicine-result">
                        <h4>City Medical Store - Nabha Main Market (0.5 km)</h4>
                        <p><strong>Paracetamol 500mg:</strong> <span style="color: #28a745;">Available</span> - ‚Çπ15 (50+ tablets)</p>
                        <p><strong>Contact:</strong> +91 98765-43210</p>
                        <button class="btn">Get Directions</button>
                    </div>
                    <div class="medicine-result">
                        <h4>Health Plus Pharmacy - Khera Village (3.2 km)</h4>
                        <p><strong>Paracetamol 500mg:</strong> <span style="color: #28a745;">Available</span> - ‚Çπ12 (100+ tablets)</p>
                        <p><strong>Contact:</strong> +91 98765-43211</p>
                        <button class="btn">Get Directions</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Symptom Checker Section -->
    <section id="symptoms-section" class="section">
        <div class="container">
            <h2 id="symptom_checker_title">ü§ñ AI Symptom Checker</h2>
            
            <!-- Voice Controls -->
            <div class="voice-controls">
                <button id="startChatBtn" onclick="startSymptomChat()" class="btn">üí¨ Start Symptom Check</button>
                <button onclick="alert('Voice feature test - this works!')" class="btn" style="background: #17a2b8;">üó∫Ô∏è Test Button</button>
                <button id="voiceBtn" onclick="toggleVoiceRecording()" class="voice-btn">
                    üé§ <span id="voiceText">Speak Your Symptoms</span>
                </button>
                <button id="speakBtn" onclick="toggleTextToSpeech()" class="voice-btn">
                    üîä <span id="speakText">AI Voice: ON</span>
                </button>
            </div>
            
            <!-- Chatbot Container -->
            <div class="card">
                <div id="chatbotContainer" class="chatbot-container">
                    <div class="chat-message ai">
                        <div class="message-avatar ai-avatar">ü§ñ</div>
                        <div class="message-bubble ai">
                            Welcome to CSE-D AI Symptom Checker! I'll ask you a few questions to help assess your symptoms. Click "Start Symptom Check" to begin.
                        </div>
                    </div>
                    
                    <!-- Typing Indicator -->
                    <div id="typingIndicator" class="typing-indicator">
                        <div class="message-avatar ai-avatar">ü§ñ</div>
                        AI Doctor is typing
                        <span class="typing-dots">
                            <span>.</span>
                            <span>.</span>
                            <span>.</span>
                        </span>
                    </div>
                </div>
                
                <!-- Chat Options (Dynamic) -->
                <div id="chatOptions" class="chat-options" style="display: none;"></div>
                
                <!-- Diagnosis Results -->
                <div id="diagnosisResult" class="diagnosis-result" style="display: none;"></div>
                
                <!-- Emergency Warning -->
                <div id="emergencyWarning" class="card" style="display: none; background: #fff5f5; border-left: 4px solid #dc3545; margin-top: 1rem;">
                    <h3 style="color: #dc3545;">‚ö†Ô∏è Emergency Alert</h3>
                    <p style="color: #721c24;">Based on your symptoms, this may require immediate medical attention. Please:</p>
                    <div style="margin: 1rem 0;">
                        <button onclick="callEmergency('108')" class="btn emergency-btn">üöë Call Emergency (108)</button>
                        <button onclick="shareLocation()" class="btn" style="background: #6c757d; margin-left: 1rem;">üìç Share Location</button>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="voice-controls" style="margin-top: 1rem;">
                    <button onclick="restartChat()" class="btn" style="background: #6c757d;">üîÑ Start Over</button>
                    <button onclick="bookConsultation()" class="btn">üë®‚Äç‚öïÔ∏è Book Consultation</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Government Schemes Section -->
    <section id="schemes-section" class="section">
        <div class="container">
            <h2 id="govt_schemes_title">üèõÔ∏è Government Health Schemes</h2>
            <div class="card">
                <h3>üè• Ayushman Bharat - PM-JAY</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <span style="background: #28a745; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem;">Active</span>
                    <span style="color: #666; font-size: 0.9rem;">Updated: Today</span>
                </div>
                <p>Free treatment up to ‚Çπ5 lakh per family per year</p>
                <div style="margin: 1rem 0;">
                    <p><strong>Eligibility:</strong> Below poverty line families</p>
                    <p><strong>Coverage:</strong> 1,393 medical packages including surgeries, treatments</p>
                    <p><strong>Hospitals:</strong> Civil Hospital Nabha, Patiala Medical College</p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn" onclick="checkEligibility('ayushman')">Check Eligibility</button>
                    <button class="btn" style="background: #6c757d;" onclick="findHospital('ayushman')">Find Hospital</button>
                </div>
            </div>
            
            <div class="card">
                <h3>üè• Punjab Health Scheme</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <span style="background: #28a745; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem;">Active</span>
                    <span style="color: #666; font-size: 0.9rem;">State Scheme</span>
                </div>
                <p>Free medicines and treatment at all government hospitals in Punjab</p>
                <div style="margin: 1rem 0;">
                    <p><strong>Eligibility:</strong> All Punjab residents</p>
                    <p><strong>Coverage:</strong> Essential medicines, OPD, emergency care</p>
                    <p><strong>Centers:</strong> All PHCs, CHCs, District Hospitals</p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn" onclick="findCenter('punjab')">Find Nearby Center</button>
                    <button class="btn" style="background: #6c757d;" onclick="downloadCard('punjab')">Get Health Card</button>
                </div>
            </div>
            
            <div class="card">
                <h3>üíä Jan Aushadhi Scheme</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <span style="background: #28a745; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem;">Active</span>
                    <span style="color: #666; font-size: 0.9rem;">Central Scheme</span>
                </div>
                <p>Generic medicines at 50-90% lower prices than branded medicines</p>
                <div style="margin: 1rem 0;">
                    <p><strong>Eligibility:</strong> Everyone can purchase</p>
                    <p><strong>Medicines:</strong> 1,500+ generic medicines available</p>
                    <p><strong>Stores:</strong> Nabha Main Market, Civil Hospital premises</p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn" onclick="findStore('janaushadhi')">Find Store</button>
                    <button class="btn" style="background: #6c757d;" onclick="comparePrices()">Compare Prices</button>
                </div>
            </div>
            
            <div class="card">
                <h3>üöë Emergency Medical Scheme</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <span style="background: #dc3545; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem;">24/7 Active</span>
                    <span style="color: #666; font-size: 0.9rem;">Emergency Only</span>
                </div>
                <p>Free ambulance service and emergency treatment for all</p>
                <div style="margin: 1rem 0;">
                    <p><strong>Service:</strong> 108 Ambulance with trained paramedics</p>
                    <p><strong>Coverage:</strong> Free emergency care at government hospitals</p>
                    <p><strong>Response:</strong> Average 15 minutes in rural areas</p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn emergency-btn" onclick="callEmergency('108')">üöë Call 108</button>
                    <button class="btn" style="background: #6c757d;" onclick="trackAmbulance()">Track Ambulance</button>
                </div>
            </div>
            
            <div class="card" style="background: #e8f4f8; border-left: 4px solid #17a2b8;">
                <h3>üìû Need Help with Schemes?</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div>
                        <strong>üìû Ayushman Bharat Helpline:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">14555</span> (Toll Free)
                    </div>
                    <div>
                        <strong>üè• Civil Hospital Nabha:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">01762-230345</span>
                    </div>
                    <div>
                        <strong>üèõÔ∏è District Health Office:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">0175-2212345</span> (Patiala)
                    </div>
                    <div>
                        <strong>üíä Jan Aushadhi Info:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">1800-180-5050</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Emergency Section -->
    <section id="emergency-section" class="section">
        <div class="container">
            <h2 style="color: #dc3545;">üö® Emergency Services</h2>
            
            <div class="card" style="background: #fff5f5; border-left: 4px solid #dc3545;">
                <h3 style="color: #dc3545;">‚ö†Ô∏è Emergency Warning Signs</h3>
                <p style="color: #721c24;"><strong>Call Emergency Services Immediately If You Have:</strong></p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 0.5rem; margin: 1rem 0;">
                    <div>‚Ä¢ Severe chest pain or pressure</div>
                    <div>‚Ä¢ Severe difficulty breathing</div>
                    <div>‚Ä¢ Loss of consciousness or confusion</div>
                    <div>‚Ä¢ Severe bleeding that won't stop</div>
                    <div>‚Ä¢ Serious head injury</div>
                    <div>‚Ä¢ High fever with confusion</div>
                    <div>‚Ä¢ Signs of stroke (facial drooping, arm weakness)</div>
                    <div>‚Ä¢ Severe allergic reaction</div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                <div class="card">
                    <h3>üöë Medical Emergency</h3>
                    <p>Free 24/7 ambulance service with trained paramedics and medical equipment</p>
                    <div style="margin: 1rem 0; color: #666; font-size: 0.9rem;">
                        <div>‚Ä¢ Average response time: 15 minutes</div>
                        <div>‚Ä¢ GPS-enabled ambulances</div>
                        <div>‚Ä¢ Free service for all</div>
                    </div>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button onclick="callEmergency('108')" class="btn emergency-btn">üìû Call 108</button>
                        <button onclick="shareLocation()" class="btn" style="background: #6c757d;">üìç Share Location</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üöì Police Emergency</h3>
                    <p>Police emergency response for crime, accidents, and law enforcement</p>
                    <div style="margin: 1rem 0; color: #666; font-size: 0.9rem;">
                        <div>‚Ä¢ Crime reporting</div>
                        <div>‚Ä¢ Accident assistance</div>
                        <div>‚Ä¢ Women safety helpline</div>
                    </div>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button onclick="callEmergency('100')" class="btn emergency-btn">üìû Call 100</button>
                        <button onclick="callEmergency('1091')" class="btn" style="background: #e91e63;">üë© Women Helpline</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üöí Fire Emergency</h3>
                    <p>Fire department emergency response for fires and rescue operations</p>
                    <div style="margin: 1rem 0; color: #666; font-size: 0.9rem;">
                        <div>‚Ä¢ Fire suppression</div>
                        <div>‚Ä¢ Rescue operations</div>
                        <div>‚Ä¢ Hazardous material response</div>
                    </div>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button onclick="callEmergency('101')" class="btn emergency-btn">üìû Call 101</button>
                        <button onclick="reportFire()" class="btn" style="background: #6c757d;">üî• Report Fire</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üè≠ Disaster Management</h3>
                    <p>Natural disaster response and emergency coordination</p>
                    <div style="margin: 1rem 0; color: #666; font-size: 0.9rem;">
                        <div>‚Ä¢ Flood response</div>
                        <div>‚Ä¢ Earthquake assistance</div>
                        <div>‚Ä¢ Emergency shelter</div>
                    </div>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button onclick="callEmergency('1070')" class="btn emergency-btn">üìû Call 1070</button>
                        <button onclick="findShelter()" class="btn" style="background: #6c757d;">üè† Find Shelter</button>
                    </div>
                </div>
            </div>
            
            <div class="card" style="background: #e8f4f8; border-left: 4px solid #17a2b8;">
                <h3>üìû Important Local Contacts</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div>
                        <strong>üè• Civil Hospital Nabha:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">01762-230345</span>
                    </div>
                    <div>
                        <strong>üöì Police Station Nabha:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">01762-230100</span>
                    </div>
                    <div>
                        <strong>üöí Fire Station:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">01762-230101</span>
                    </div>
                    <div>
                        <strong>üè• District Hospital Patiala:</strong><br>
                        <span style="color: #17a2b8; font-weight: bold;">0175-2212345</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üìç Your Location</h3>
                <div id="locationDisplay" style="background: #f8f9fa; padding: 1rem; border-radius: 4px; margin: 1rem 0;">
                    <p style="margin: 0; color: #666;">Click "Get My Location" to share your current location with emergency services</p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button onclick="getCurrentLocation()" class="btn">üìç Get My Location</button>
                    <button onclick="sendLocationSMS()" class="btn" style="background: #6c757d;">üì± Send Location SMS</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Status Messages -->
    <div id="statusMessage" class="status-message"></div>

    <script>
        // Translation data
        const translations = {
            en: {
                app_title: "CSE-D Telemedicine",
                patient_portal: "Patient Portal",
                patient_portal_title: "Patient Portal",
                doctor_portal: "Doctor Portal",
                pharmacy_portal: "Pharmacy Portal",
                symptom_checker: "Symptom Checker",
                emergency: "üö® Emergency",
                tab_registration: "Registration",
                tab_login: "Login",
                patient_registration: "Patient Registration",
                patient_login: "Patient Login",
                basic_info: "üìã Basic Information",
                medical_info: "ü©∫ Medical Information",
                full_name: "Full Name:",
                village: "Village/Address:",
                phone: "Phone Number:",
                age: "Age:",
                gender: "Gender:",
                select_gender: "Select Gender",
                male: "Male",
                female: "Female",
                other: "Other",
                password: "Password:",
                blood_group: "Blood Group:",
                select_blood_group: "Select Blood Group",
                height: "Height (cm):",
                weight: "Weight (kg):",
                sugar_level: "Sugar Level (mg/dL):",
                blood_pressure_systolic: "Blood Pressure (Systolic):",
                blood_pressure_diastolic: "Blood Pressure (Diastolic):",
                medical_history: "Medical History:",
                current_symptoms: "Current Symptoms:",
                symptoms: "Describe your symptoms:",
                urgency: "Urgency Level:",
                low: "Low",
                medium: "Medium",
                high: "High",
                emergency_level: "Emergency",
                register_btn: "Register & Submit Request",
                login_phone: "Phone Number:",
                login_password: "Password:",
                login_btn: "Login",
                patient_profile_title: "üë§ Patient Profile",
                profile_name_label: "Name:",
                profile_age_label: "Age:",
                profile_gender_label: "Gender:",
                profile_phone_label: "Phone:",
                profile_blood_group_label: "Blood Group:",
                profile_village_label: "Address:",
                medical_info_title: "ü©∫ Medical Information",
                profile_height_label: "Height:",
                profile_weight_label: "Weight:",
                profile_sugar_label: "Sugar Level:",
                profile_bp_label: "Blood Pressure:",
                profile_history_label: "Medical History:",
                request_consultation_btn: "Request New Consultation",
                logout_btn: "Logout",
                submit_request: "Submit Request",
                doctor_dashboard: "Doctor Dashboard",
                pending_requests: "Pending Patient Requests",
                medicine_availability: "Medicine Availability",
                search_medicines: "Search Medicines",
                search: "Search",
                symptom_checker_title: "AI Symptom Checker"
            },
            hi: {
                app_title: "CSE-D ‡§ü‡•á‡§≤‡•Ä‡§Æ‡•á‡§°‡§ø‡§∏‡§ø‡§®",
                patient_portal: "‡§Æ‡§∞‡•Ä‡§ú‡§º ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
                doctor_portal: "‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
                pharmacy_portal: "‡§¶‡§µ‡§æ‡§ñ‡§æ‡§®‡§æ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
                symptom_checker: "‡§≤‡§ï‡•ç‡§∑‡§£ ‡§ú‡§æ‡§Ç‡§ö‡§ï‡§∞‡•ç‡§§‡§æ",
                emergency: "üö® ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤",
                patient_registration: "‡§Æ‡§∞‡•Ä‡§ú‡§º ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£",
                full_name: "‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ:",
                village: "‡§ó‡§æ‡§Ç‡§µ:",
                phone: "‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞:",
                age: "‡§â‡§Æ‡•ç‡§∞:",
                symptoms: "‡§Ö‡§™‡§®‡•á ‡§≤‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡§∞‡•ç‡§£‡§® ‡§ï‡§∞‡•á‡§Ç:",
                urgency: "‡§§‡§æ‡§§‡•ç‡§ï‡§æ‡§≤‡§ø‡§ï‡§§‡§æ ‡§∏‡•ç‡§§‡§∞:",
                low: "‡§ï‡§Æ",
                medium: "‡§Æ‡§ß‡•ç‡§Ø‡§Æ",
                high: "‡§â‡§ö‡•ç‡§ö",
                emergency_level: "‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤",
                submit_request: "‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡•á‡§Ç",
                doctor_dashboard: "‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                pending_requests: "‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Æ‡§∞‡•Ä‡§ú‡§º ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß",
                medicine_availability: "‡§¶‡§µ‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ",
                search_medicines: "‡§¶‡§µ‡§æ‡§è‡§Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç",
                search: "‡§ñ‡•ã‡§ú‡•á‡§Ç",
                symptom_checker_title: "AI ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§ú‡§æ‡§Ç‡§ö‡§ï‡§∞‡•ç‡§§‡§æ"
            },
            te: {
                app_title: "CSE-D ‡∞ü‡±Ü‡∞≤‡∞ø‡∞Æ‡±Ü‡∞°‡∞ø‡∞∏‡∞ø‡∞®‡±ç",
                patient_portal: "‡∞∞‡±ã‡∞ó‡∞ø ‡∞™‡±ã‡∞∞‡±ç‡∞ü‡∞≤‡±ç",
                doctor_portal: "‡∞°‡∞æ‡∞ï‡±ç‡∞ü‡∞∞‡±ç ‡∞™‡±ã‡∞∞‡±ç‡∞ü‡∞≤‡±ç",
                pharmacy_portal: "‡∞Æ‡∞∞‡±Å‡∞®‡±ç‡∞®‡±Å ‡∞™‡±ã‡∞∞‡±ç‡∞ü‡∞≤‡±ç",
                symptom_checker: "‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤ ‡∞™‡∞∞‡±Ä‡∞ï‡±ç‡∞∑‡∞ï‡±Å‡∞°‡±Å",
                emergency: "üö® ‡∞é‡∞Æ‡∞∞‡±ç‡∞ú‡±Ü‡∞®‡±ç‡∞∏‡±Ä",
                patient_registration: "‡∞∞‡±ã‡∞ó‡∞ø ‡∞®‡∞Æ‡±ã‡∞¶‡±Å",
                full_name: "‡∞™‡±Ç‡∞∞‡±ç‡∞£ ‡∞™‡±á‡∞∞‡±Å:",
                village: "‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç/‡∞ï‡∞ø‡∞∞‡∞æ‡∞®‡∞æ:",
                phone: "‡∞´‡±ã‡∞®‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç:",
                age: "‡∞µ‡∞Ø‡∞∏‡±ç‡∞∏‡±Å:",
                symptoms: "‡∞Æ‡±Ä ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡∞®‡±ç‡∞®‡∞ø ‡∞µ‡∞ø‡∞µ‡∞∞‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:",
                urgency: "‡∞ï‡±ç‡∞∑‡∞ø‡∞™‡±ç‡∞∞‡∞§‡∞æ ‡∞∏‡±ç‡∞•‡∞æ‡∞Ø‡∞ø:",
                low: "‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ",
                medium: "‡∞Æ‡∞ß‡±ç‡∞Ø‡∞Æ‡∞Ç",
                high: "‡∞é‡∞ï‡±ç‡∞ï‡±Å‡∞µ",
                emergency_level: "‡∞é‡∞Æ‡∞∞‡±ç‡∞ú‡±Ü‡∞®‡±ç‡∞∏‡±Ä",
                submit_request: "‡∞Ö‡∞∞‡±ç‡∞ú‡∞ø ‡∞™‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø",
                doctor_dashboard: "‡∞°‡∞æ‡∞ï‡±ç‡∞ü‡∞∞‡±ç ‡∞°‡∞æ‡∞∑‡±ç‚Äå‡∞¨‡±ã‡∞∞‡±ç‡∞°‡±ç",
                pending_requests: "‡∞™‡±Ü‡∞Ç‡∞°‡∞ø‡∞Ç‡∞ó‡±ç ‡∞∞‡±ã‡∞ó‡∞ø ‡∞Ö‡∞∞‡±ç‡∞ú‡∞ø‡∞≤‡±Å",
                medicine_availability: "‡∞Æ‡∞∞‡±Å‡∞®‡±ç‡∞®‡±Å ‡∞≤‡∞≠‡±ç‡∞Ø‡∞§",
                search_medicines: "‡∞Æ‡∞∞‡±Å‡∞®‡±ç‡∞®‡±Å‡∞≤‡∞®‡±Å ‡∞§‡±Ü‡∞≤‡±Å‡∞∏‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø",
                search: "‡∞§‡±Ü‡∞≤‡±Å‡∞∏‡±Å‡∞ï‡±ã",
                symptom_checker_title: "AI ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤ ‡∞™‡∞∞‡±Ä‡∞ï‡±ç‡∞∑‡∞ï‡±Å‡∞°‡±Å"
            }
        };

        let currentLanguage = 'en';
        let selectedSymptoms = [];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            showSection('patient');
        });

        // Setup event listeners
        function setupEventListeners() {
            // Language selector
            document.getElementById('languageSelect').addEventListener('change', function(e) {
                changeLanguage(e.target.value);
            });

            // Patient registration form
            const regForm = document.getElementById('patientRegistrationForm');
            if (regForm) {
                regForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    registerPatient();
                });
            }

            // Patient login form
            const loginForm = document.getElementById('patientLoginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    loginPatient();
                });
            }

            // Doctor registration form
            const doctorRegForm = document.getElementById('doctorRegistrationForm');
            if (doctorRegForm) {
                doctorRegForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    registerDoctor();
                });
            }

            // Doctor login form
            const doctorLoginForm = document.getElementById('doctorLoginForm');
            if (doctorLoginForm) {
                doctorLoginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    loginDoctor();
                });
            }
        }

        // Patient Portal Functions
        function showPatientTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.patient-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from all tab buttons
            document.querySelectorAll('.patient-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');

            console.log('Switched to patient tab:', tabName);
        }

        function registerPatient() {
            const formData = {
                name: document.getElementById('regPatientName').value,
                age: document.getElementById('regPatientAge').value,
                phone: document.getElementById('regPatientPhone').value,
                gender: document.getElementById('regPatientGender').value,
                village: document.getElementById('regPatientVillage').value,
                password: document.getElementById('regPatientPassword').value,
                bloodGroup: document.getElementById('regBloodGroup').value,
                height: document.getElementById('regHeight').value,
                weight: document.getElementById('regWeight').value,
                sugarLevel: document.getElementById('regSugarLevel').value,
                bpSystolic: document.getElementById('regBPSystolic').value,
                bpDiastolic: document.getElementById('regBPDiastolic').value,
                medicalHistory: document.getElementById('regMedicalHistory').value,
                currentSymptoms: document.getElementById('regCurrentSymptoms').value,
                urgency: document.getElementById('regUrgencyLevel').value,
                registrationDate: new Date().toISOString()
            };

            // Save patient data to localStorage
            const patients = JSON.parse(localStorage.getItem('patients') || '[]');
            
            // Check if patient already exists
            const existingPatient = patients.find(p => p.phone === formData.phone);
            if (existingPatient) {
                showStatusMessage('Patient with this phone number already exists!', 'error');
                return;
            }

            patients.push(formData);
            localStorage.setItem('patients', JSON.stringify(patients));
            
            // Also save the consultation request
            const requests = JSON.parse(localStorage.getItem('consultationRequests') || '[]');
            requests.push({
                ...formData,
                id: 'REQ-' + Date.now(),
                timestamp: new Date().toISOString(),
                status: 'pending'
            });
            localStorage.setItem('consultationRequests', JSON.stringify(requests));

            showStatusMessage('Registration successful! Consultation request submitted.', 'success');
            document.getElementById('patientRegistrationForm').reset();
            
            // Switch to login tab
            setTimeout(() => {
                showPatientTab('login');
            }, 2000);
        }

        function loginPatient() {
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;

            const patients = JSON.parse(localStorage.getItem('patients') || '[]');
            const patient = patients.find(p => p.phone === phone && p.password === password);

            if (patient) {
                displayPatientProfile(patient);
                showStatusMessage('Login successful!', 'success');
                document.getElementById('patientLoginForm').reset();
            } else {
                showStatusMessage('Invalid phone number or password!', 'error');
            }
        }

        function displayPatientProfile(patient) {
            document.getElementById('profileName').textContent = patient.name;
            document.getElementById('profileAge').textContent = patient.age + ' years';
            document.getElementById('profileGender').textContent = patient.gender;
            document.getElementById('profilePhone').textContent = patient.phone;
            document.getElementById('profileBloodGroup').textContent = patient.bloodGroup || '-';
            document.getElementById('profileVillage').textContent = patient.village;
            
            document.getElementById('profileHeight').textContent = patient.height ? patient.height + ' cm' : '-';
            document.getElementById('profileWeight').textContent = patient.weight ? patient.weight + ' kg' : '-';
            document.getElementById('profileSugar').textContent = patient.sugarLevel ? patient.sugarLevel + ' mg/dL' : '-';
            
            const bp = patient.bpSystolic && patient.bpDiastolic ? 
                `${patient.bpSystolic}/${patient.bpDiastolic} mmHg` : '-';
            document.getElementById('profileBP').textContent = bp;
            
            document.getElementById('profileMedicalHistory').textContent = patient.medicalHistory || 'No medical history recorded.';

            document.getElementById('patientProfile').style.display = 'block';
            document.getElementById('patientLoginForm').parentElement.style.display = 'none';
        }

        function requestConsultation() {
            // This would typically open a form for new consultation request
            alert('New consultation request feature coming soon!');
        }

        function logoutPatient() {
            document.getElementById('patientProfile').style.display = 'none';
            document.getElementById('patientLoginForm').parentElement.style.display = 'block';
            showStatusMessage('Logged out successfully!', 'success');
        }

        // Doctor Portal Functions
        function showDoctorTab(tabName) {
            // Hide all doctor tab contents
            document.querySelectorAll('.patient-tab-content').forEach(tab => {
                if (tab.id.includes('doctor')) {
                    tab.classList.remove('active');
                }
            });

            // Remove active class from doctor tab buttons
            document.querySelectorAll('#doctor_tab_registration, #doctor_tab_login').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected doctor tab
            document.getElementById('doctor-' + tabName + '-tab').classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');

            console.log('Switched to doctor tab:', tabName);
        }

        function registerDoctor() {
            const formData = {
                name: document.getElementById('regDoctorName').value,
                phone: document.getElementById('regDoctorPhone').value,
                address: document.getElementById('regDoctorAddress').value,
                password: document.getElementById('regDoctorPassword').value,
                qualification: document.getElementById('regDoctorQualification').value,
                specialization: document.getElementById('regDoctorSpecialization').value,
                experience: document.getElementById('regDoctorExperience').value,
                license: document.getElementById('regDoctorLicense').value,
                education: document.getElementById('regDoctorEducation').value,
                practice: document.getElementById('regDoctorPractice').value,
                registrationDate: new Date().toISOString()
            };

            // Save doctor data to localStorage
            const doctors = JSON.parse(localStorage.getItem('doctors') || '[]');
            
            // Check if doctor already exists
            const existingDoctor = doctors.find(d => d.phone === formData.phone);
            if (existingDoctor) {
                showStatusMessage('Doctor with this phone number already exists!', 'error');
                return;
            }

            doctors.push(formData);
            localStorage.setItem('doctors', JSON.stringify(doctors));

            showStatusMessage('Doctor registration successful!', 'success');
            document.getElementById('doctorRegistrationForm').reset();
            
            // Switch to login tab
            setTimeout(() => {
                showDoctorTab('login');
            }, 2000);
        }

        function loginDoctor() {
            const phone = document.getElementById('loginDoctorPhone').value;
            const password = document.getElementById('loginDoctorPassword').value;

            const doctors = JSON.parse(localStorage.getItem('doctors') || '[]');
            const doctor = doctors.find(d => d.phone === phone && d.password === password);

            if (doctor) {
                displayDoctorProfile(doctor);
                showStatusMessage('Doctor login successful!', 'success');
                document.getElementById('doctorLoginForm').reset();
            } else {
                showStatusMessage('Invalid phone number or password!', 'error');
            }
        }

        function displayDoctorProfile(doctor) {
            document.getElementById('doctorProfileName').textContent = doctor.name;
            document.getElementById('doctorProfilePhone').textContent = doctor.phone;
            document.getElementById('doctorProfileAddress').textContent = doctor.address;
            document.getElementById('doctorProfileQualification').textContent = doctor.qualification || '-';
            document.getElementById('doctorProfileSpecialization').textContent = doctor.specialization || '-';
            document.getElementById('doctorProfileExperience').textContent = doctor.experience ? doctor.experience + ' years' : '-';
            document.getElementById('doctorProfileLicense').textContent = doctor.license || '-';
            
            document.getElementById('doctorProfileEducation').textContent = doctor.education || 'No education background recorded.';
            document.getElementById('doctorProfilePractice').textContent = doctor.practice || 'No current practice information recorded.';

            document.getElementById('doctorProfile').style.display = 'block';
            document.getElementById('doctorLoginForm').parentElement.style.display = 'none';
        }

        function viewPendingRequests() {
            document.getElementById('doctorDashboard').style.display = 'block';
            showStatusMessage('Showing patient requests...', 'success');
        }

        function logoutDoctor() {
            document.getElementById('doctorProfile').style.display = 'none';
            document.getElementById('doctorDashboard').style.display = 'none';
            document.getElementById('doctorLoginForm').parentElement.style.display = 'block';
            showStatusMessage('Doctor logged out successfully!', 'success');
        }

        // Show section
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-links button').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName + '-section').classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');

            console.log('Switched to section:', sectionName);
        }

        // Change language
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Update all translatable elements
            Object.keys(translations[lang]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.tagName === 'INPUT' && element.type === 'submit') {
                        element.value = translations[lang][key];
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });

            console.log('Language changed to:', lang);
        }

        // AI Symptom Checker Variables
        let currentQuestion = 0;
        let chatActive = false;
        let userResponses = {};
        let voiceRecognition = null;
        let speechSynthesis = window.speechSynthesis;
        let aiVoiceEnabled = true;
        let isRecording = false;

        // Symptom Assessment Questions
        const symptomQuestions = [
            {
                id: 'main_symptom',
                question: "What is your main symptom or concern today?",
                options: [
                    { text: "Fever", value: "fever" },
                    { text: "Headache", value: "headache" },
                    { text: "Cough", value: "cough" },
                    { text: "Stomach Pain", value: "stomach_pain" },
                    { text: "Body Ache", value: "body_ache" },
                    { text: "Breathing Issues", value: "breathing" }
                ]
            },
            {
                id: 'severity',
                question: "How would you rate the severity of your symptoms?",
                options: [
                    { text: "Mild (1-3)", value: "mild" },
                    { text: "Moderate (4-6)", value: "moderate" },
                    { text: "Severe (7-10)", value: "severe" }
                ]
            },
            {
                id: 'duration',
                question: "How long have you been experiencing these symptoms?",
                options: [
                    { text: "Less than 1 day", value: "less_1day" },
                    { text: "1-3 days", value: "1_3days" },
                    { text: "4-7 days", value: "4_7days" },
                    { text: "More than 1 week", value: "more_1week" }
                ]
            },
            {
                id: 'additional_symptoms',
                question: "Do you have any of these additional symptoms?",
                options: [
                    { text: "Nausea/Vomiting", value: "nausea" },
                    { text: "Dizziness", value: "dizziness" },
                    { text: "Fatigue/Weakness", value: "fatigue" },
                    { text: "Loss of Appetite", value: "appetite_loss" },
                    { text: "None of the above", value: "none" }
                ]
            },
            {
                id: 'recent_changes',
                question: "Have you experienced any of these recently?",
                options: [
                    { text: "Travel to new places", value: "travel" },
                    { text: "Change in diet", value: "diet_change" },
                    { text: "High stress/anxiety", value: "stress" },
                    { text: "Contact with sick person", value: "contact_sick" },
                    { text: "None of the above", value: "none" }
                ]
            },
            {
                id: 'medical_history',
                question: "Do you have any existing medical conditions?",
                options: [
                    { text: "Diabetes", value: "diabetes" },
                    { text: "High Blood Pressure", value: "hypertension" },
                    { text: "Heart Problems", value: "heart" },
                    { text: "Asthma/Respiratory Issues", value: "respiratory" },
                    { text: "No existing conditions", value: "none" }
                ]
            }
        ];

        // Start Symptom Chat
        function startSymptomChat() {
            console.log('startSymptomChat called'); // Debug log
            
            try {
                currentQuestion = 0;
                chatActive = true;
                userResponses = {};
                
                // Clear previous chat
                const container = document.getElementById('chatbotContainer');
                if (!container) {
                    console.error('chatbotContainer not found');
                    return;
                }
                
                container.innerHTML = `
                    <div class="chat-message ai">
                        <div class="message-avatar ai-avatar">ü§ñ</div>
                        <div class="message-bubble ai">
                            Hi! I'm your AI health assistant. I'll ask you 6 questions to better understand your symptoms and provide guidance.
                        </div>
                    </div>
                `;
                
                // Hide results and start first question
                const diagnosisDiv = document.getElementById('diagnosisResult');
                const emergencyDiv = document.getElementById('emergencyWarning');
                
                if (diagnosisDiv) diagnosisDiv.style.display = 'none';
                if (emergencyDiv) emergencyDiv.style.display = 'none';
                
                showStatusMessage('Starting symptom assessment...', 'success');
                
                setTimeout(() => {
                    askQuestion(0);
                }, 1000);
                
            } catch (error) {
                console.error('Error in startSymptomChat:', error);
                showStatusMessage('Error starting symptom checker: ' + error.message, 'error');
            }
        }
        
        // Make function globally accessible
        window.startSymptomChat = startSymptomChat;

        // Ask Question
        function askQuestion(questionIndex) {
            if (questionIndex >= symptomQuestions.length) {
                analyzeSymptomsAndProvideResults();
                return;
            }

            const question = symptomQuestions[questionIndex];
            
            // Show typing indicator
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                
                // Add AI question
                addChatMessage('ai', `Question ${questionIndex + 1}/6: ${question.question}`);
                
                // Speak question if voice is enabled
                if (aiVoiceEnabled) {
                    speakText(question.question);
                }
                
                // Show options
                showQuestionOptions(question.options, questionIndex);
            }, 1500);
        }

        // Show Question Options
        function showQuestionOptions(options, questionIndex) {
            const optionsDiv = document.getElementById('chatOptions');
            optionsDiv.innerHTML = '';
            
            options.forEach(option => {
                const btn = document.createElement('div');
                btn.className = 'chat-option';
                btn.textContent = option.text;
                btn.onclick = () => selectOption(option, questionIndex);
                optionsDiv.appendChild(btn);
            });
            
            optionsDiv.style.display = 'flex';
        }

        // Select Option
        function selectOption(option, questionIndex) {
            const question = symptomQuestions[questionIndex];
            userResponses[question.id] = option.value;
            
            // Add user response to chat
            addChatMessage('user', option.text);
            
            // Hide options
            document.getElementById('chatOptions').style.display = 'none';
            
            // Move to next question
            currentQuestion = questionIndex + 1;
            setTimeout(() => {
                askQuestion(currentQuestion);
            }, 500);
        }

        // Add Chat Message
        function addChatMessage(sender, message) {
            const container = document.getElementById('chatbotContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            
            const avatar = sender === 'ai' ? 'ü§ñ' : 'üë§';
            const avatarClass = sender === 'ai' ? 'ai-avatar' : 'user-avatar';
            
            messageDiv.innerHTML = `
                <div class="message-avatar ${avatarClass}">${avatar}</div>
                <div class="message-bubble ${sender}">${message}</div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Show/Hide Typing Indicator
        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'flex';
            const container = document.getElementById('chatbotContainer');
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // Analyze Symptoms and Provide Results
        function analyzeSymptomsAndProvideResults() {
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                
                const assessment = calculateSymptomAssessment(userResponses);
                
                addChatMessage('ai', 'Thank you for answering all my questions. Let me analyze your symptoms...');
                
                setTimeout(() => {
                    displayDiagnosis(assessment);
                }, 2000);
            }, 1500);
        }

        // Calculate Symptom Assessment
        function calculateSymptomAssessment(responses) {
            let urgencyScore = 0;
            let diagnosis = '';
            let recommendations = [];
            
            // Assess main symptom
            switch(responses.main_symptom) {
                case 'fever':
                    urgencyScore += responses.severity === 'severe' ? 3 : responses.severity === 'moderate' ? 2 : 1;
                    diagnosis = 'Possible viral or bacterial infection';
                    break;
                case 'headache':
                    urgencyScore += responses.severity === 'severe' ? 2 : 1;
                    diagnosis = responses.severity === 'severe' ? 'Severe headache - possible migraine' : 'Tension headache';
                    break;
                case 'cough':
                    urgencyScore += responses.additional_symptoms === 'fatigue' ? 2 : 1;
                    diagnosis = 'Respiratory tract infection';
                    break;
                case 'stomach_pain':
                    urgencyScore += responses.severity === 'severe' ? 3 : 2;
                    diagnosis = 'Gastrointestinal distress';
                    break;
                case 'breathing':
                    urgencyScore += 4; // Always high priority
                    diagnosis = 'Respiratory difficulty';
                    break;
                default:
                    urgencyScore += 1;
                    diagnosis = 'General discomfort';
            }
            
            // Adjust for severity and duration
            if (responses.severity === 'severe') urgencyScore += 2;
            if (responses.duration === 'more_1week') urgencyScore += 1;
            if (responses.additional_symptoms !== 'none') urgencyScore += 1;
            
            // Medical history factors
            if (responses.medical_history !== 'none') {
                urgencyScore += 1;
                recommendations.push('Consider your existing medical condition');
            }
            
            // Determine urgency level
            let urgency, urgencyClass, actions;
            if (urgencyScore >= 6) {
                urgency = 'Emergency';
                urgencyClass = 'urgency-emergency';
                actions = ['Call emergency services immediately (108)', 'Go to nearest emergency room', 'Do not delay seeking medical attention'];
            } else if (urgencyScore >= 3) {
                urgency = 'Urgent';
                urgencyClass = 'urgency-urgent';
                actions = ['Consult a doctor within 24 hours', 'Monitor symptoms closely', 'Consider visiting a clinic today'];
            } else {
                urgency = 'Mild';
                urgencyClass = 'urgency-mild';
                actions = ['Rest and monitor symptoms', 'Stay hydrated', 'Consult doctor if symptoms persist beyond 2-3 days'];
            }
            
            // Add general recommendations
            recommendations.push('Take adequate rest', 'Stay hydrated', 'Maintain good hygiene');
            
            return {
                diagnosis,
                urgency,
                urgencyClass,
                urgencyScore,
                actions,
                recommendations
            };
        }

        // Display Diagnosis
        function displayDiagnosis(assessment) {
            const resultDiv = document.getElementById('diagnosisResult');
            
            resultDiv.innerHTML = `
                <h3>üè• AI Health Assessment</h3>
                <div style="margin: 1rem 0;">
                    <strong>Preliminary Assessment:</strong>
                    <p style="margin: 0.5rem 0;">${assessment.diagnosis}</p>
                </div>
                
                <div style="margin: 1rem 0;">
                    <strong>Urgency Level:</strong>
                    <span class="urgency-badge ${assessment.urgencyClass}">${assessment.urgency}</span>
                </div>
                
                <div style="margin: 1rem 0;">
                    <strong>Recommended Actions:</strong>
                    <ul style="margin: 0.5rem 0; padding-left: 2rem;">
                        ${assessment.actions.map(action => `<li style="margin: 0.25rem 0;">${action}</li>`).join('')}
                    </ul>
                </div>
                
                <div style="margin: 1rem 0;">
                    <strong>General Care Tips:</strong>
                    <ul style="margin: 0.5rem 0; padding-left: 2rem;">
                        ${assessment.recommendations.map(rec => `<li style="margin: 0.25rem 0;">${rec}</li>`).join('')}
                    </ul>
                </div>
                
                <div style="margin: 1.5rem 0; padding: 1rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #17a2b8;">
                    <strong>‚ö†Ô∏è Disclaimer:</strong> This assessment is for informational purposes only and does not replace professional medical diagnosis. Always consult with a qualified healthcare provider for proper medical advice.
                </div>
            `;
            
            resultDiv.style.display = 'block';
            
            // Show emergency warning for high urgency
            if (assessment.urgency === 'Emergency') {
                document.getElementById('emergencyWarning').style.display = 'block';
            }
            
            // Speak result if voice enabled
            if (aiVoiceEnabled) {
                speakText(`Assessment complete. Your condition appears to be ${assessment.urgency.toLowerCase()}. ${assessment.actions[0]}`);
            }
            
            chatActive = false;
        }

        // Voice Recognition Functions
        function toggleVoiceRecording() {
            console.log('toggleVoiceRecording called');
            
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                showStatusMessage('Speech recognition not supported in this browser', 'error');
                return;
            }

            if (isRecording) {
                stopVoiceRecording();
            } else {
                startVoiceRecording();
            }
        }

        function startVoiceRecording() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            voiceRecognition = new SpeechRecognition();
            
            voiceRecognition.continuous = false;
            voiceRecognition.interimResults = false;
            voiceRecognition.lang = 'en-US';

            voiceRecognition.onstart = function() {
                isRecording = true;
                document.getElementById('voiceBtn').classList.add('recording');
                document.getElementById('voiceText').textContent = 'Listening...';
                showStatusMessage('Listening... Speak now!', 'success');
            };

            voiceRecognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                addChatMessage('user', `üé§ ${transcript}`);
                
                // Process voice input (could be enhanced to match with options)
                showStatusMessage(`You said: "${transcript}"`, 'success');
            };

            voiceRecognition.onerror = function(event) {
                showStatusMessage('Voice recognition error: ' + event.error, 'error');
                stopVoiceRecording();
            };

            voiceRecognition.onend = function() {
                stopVoiceRecording();
            };

            voiceRecognition.start();
        }

        function stopVoiceRecording() {
            if (voiceRecognition) {
                voiceRecognition.stop();
            }
            isRecording = false;
            document.getElementById('voiceBtn').classList.remove('recording');
            document.getElementById('voiceText').textContent = 'Speak Your Symptoms';
        }

        // Text-to-Speech Functions
        function toggleTextToSpeech() {
            aiVoiceEnabled = !aiVoiceEnabled;
            const speakBtn = document.getElementById('speakText');
            speakBtn.textContent = aiVoiceEnabled ? 'AI Voice: ON' : 'AI Voice: OFF';
            
            if (!aiVoiceEnabled) {
                speechSynthesis.cancel(); // Stop any current speech
            }
            
            showStatusMessage(`AI Voice ${aiVoiceEnabled ? 'enabled' : 'disabled'}`, 'success');
        }

        function speakText(text) {
            if (!aiVoiceEnabled || !speechSynthesis) return;
            
            speechSynthesis.cancel(); // Cancel any ongoing speech
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 0.8;
            
            // Try to use a female voice if available
            const voices = speechSynthesis.getVoices();
            const femaleVoice = voices.find(voice => 
                voice.name.includes('Female') || 
                voice.name.includes('Samantha') ||
                voice.name.includes('Karen')
            );
            
            if (femaleVoice) {
                utterance.voice = femaleVoice;
            }
            
            speechSynthesis.speak(utterance);
        }

        // Utility Functions
        function restartChat() {
            currentQuestion = 0;
            chatActive = false;
            userResponses = {};
            
            // Reset UI
            document.getElementById('chatOptions').style.display = 'none';
            document.getElementById('diagnosisResult').style.display = 'none';
            document.getElementById('emergencyWarning').style.display = 'none';
            
            // Reset chat container
            const container = document.getElementById('chatbotContainer');
            container.innerHTML = `
                <div class="chat-message ai">
                    <div class="message-avatar ai-avatar">ü§ñ</div>
                    <div class="message-bubble ai">
                        Welcome back to CSE-D AI Symptom Checker! Click "Start Symptom Check" to begin a new assessment.
                    </div>
                </div>
            `;
            
            showStatusMessage('Chat reset. Ready for new assessment!', 'success');
        }

        function bookConsultation() {
            showStatusMessage('Redirecting to consultation booking...', 'success');
            alert('Consultation Booking:\n\nThis feature would connect you with available doctors.\n\nFor now, please use the Patient Portal to register and request a consultation.');
            // Could redirect to patient portal or specific booking page
        }
        
        // Make all symptom checker functions globally accessible
        window.toggleVoiceRecording = toggleVoiceRecording;
        window.toggleTextToSpeech = toggleTextToSpeech;
        window.restartChat = restartChat;
        window.bookConsultation = bookConsultation;

        // Search medicine
        function searchMedicine() {
            const searchTerm = document.getElementById('medicineSearch').value;
            const resultsDiv = document.getElementById('medicineResults');
            
            if (!searchTerm) {
                showStatusMessage('Please enter a medicine name', 'error');
                return;
            }

            // Show search results (using existing mock data)
            resultsDiv.style.display = 'block';
            showStatusMessage(`Searched for: ${searchTerm}`, 'success');

            console.log('Medicine searched:', searchTerm);
        }

        // Call emergency
        function callEmergency(number) {
            if (confirm(`Call emergency number ${number}?`)) {
                showStatusMessage(`Calling ${number}...`, 'success');
                // In real app, this would initiate the call
                window.open(`tel:${number}`);
            }
        }

        // Show status message
        function showStatusMessage(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status-message ${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        // Government Schemes Functions
        function checkEligibility(scheme) {
            let message = '';
            switch(scheme) {
                case 'ayushman':
                    message = 'Ayushman Bharat Eligibility Check:\n\nYou need:\n‚Ä¢ Ration card (BPL/APL)\n‚Ä¢ Aadhaar card\n‚Ä¢ Family income certificate\n\nVisit: Civil Hospital Nabha or call 14555';
                    break;
                default:
                    message = 'Eligibility information will be displayed here.';
            }
            alert(message);
            showStatusMessage(`Checked eligibility for ${scheme}`, 'success');
        }
        
        function findHospital(scheme) {
            showStatusMessage('Finding nearby hospitals...', 'success');
            alert('Nearby Hospitals for ' + scheme + ':\n\n1. Civil Hospital Nabha - 2.5 km\n2. Patiala Medical College - 45 km\n3. Rajindra Hospital - 48 km');
        }
        
        function findCenter(scheme) {
            showStatusMessage('Finding health centers...', 'success');
            alert('Nearby Health Centers:\n\n1. PHC Nabha - 1 km\n2. CHC Samana - 15 km\n3. District Hospital Patiala - 45 km');
        }
        
        function downloadCard(scheme) {
            showStatusMessage('Generating health card...', 'success');
            alert('Health card download initiated. You will receive SMS with download link.');
        }
        
        function findStore(scheme) {
            showStatusMessage('Finding Jan Aushadhi stores...', 'success');
            alert('Jan Aushadhi Stores:\n\n1. Nabha Main Market - 0.8 km\n2. Civil Hospital Campus - 2.5 km\n3. Bus Stand Road - 1.2 km');
        }
        
        function comparePrices() {
            showStatusMessage('Loading price comparison...', 'success');
            alert('Medicine Price Comparison:\n\nParacetamol 500mg:\n‚Ä¢ Branded: ‚Çπ45\n‚Ä¢ Jan Aushadhi: ‚Çπ8\n‚Ä¢ Savings: 82%\n\nAmoxicillin 250mg:\n‚Ä¢ Branded: ‚Çπ120\n‚Ä¢ Jan Aushadhi: ‚Çπ25\n‚Ä¢ Savings: 79%');
        }
        
        function trackAmbulance() {
            showStatusMessage('Tracking ambulance...', 'success');
            alert('Ambulance Status:\n\nNearest ambulance: PB-10-AB-1234\nLocation: 5 km away\nETA: 12 minutes\n\nDriver: Rajesh Kumar\nPhone: +91 98765-11108');
        }
        
        // Emergency Functions
        function shareLocation() {
            showStatusMessage('Getting location...', 'success');
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    showStatusMessage(`Location shared: ${lat.toFixed(6)}, ${lon.toFixed(6)}`, 'success');
                    alert(`Your location has been shared with emergency services:\n\nLatitude: ${lat.toFixed(6)}\nLongitude: ${lon.toFixed(6)}\n\nEmergency services have been notified.`);
                }, function() {
                    showStatusMessage('Location access denied', 'error');
                });
            } else {
                alert('Geolocation is not supported by this browser.');
            }
        }
        
        function reportFire() {
            showStatusMessage('Reporting fire emergency...', 'success');
            alert('Fire Emergency Report:\n\nYour report has been filed.\nFire department has been notified.\nReference ID: FIRE-' + Date.now().toString().slice(-6));
        }
        
        function findShelter() {
            showStatusMessage('Finding emergency shelters...', 'success');
            alert('Emergency Shelters:\n\n1. Community Center Nabha - 2 km\n2. Government School - 1.5 km\n3. Gurudwara Sahib - 3 km\n\nAll shelters have basic facilities and are open 24/7.');
        }
        
        function getCurrentLocation() {
            const locationDisplay = document.getElementById('locationDisplay');
            locationDisplay.innerHTML = '<p style="margin: 0; color: #666;">Getting your location...</p>';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    locationDisplay.innerHTML = `
                        <p style="margin: 0;"><strong>Your Location:</strong></p>
                        <p style="margin: 0.5rem 0;">üìç Latitude: ${lat.toFixed(6)}</p>
                        <p style="margin: 0.5rem 0;">üìç Longitude: ${lon.toFixed(6)}</p>
                        <p style="margin: 0.5rem 0; color: #28a745;">‚úÖ Location ready to share with emergency services</p>
                    `;
                    showStatusMessage('Location obtained successfully', 'success');
                }, function() {
                    locationDisplay.innerHTML = '<p style="margin: 0; color: #dc3545;">‚ùå Unable to get location. Please check your browser permissions.</p>';
                    showStatusMessage('Location access denied', 'error');
                });
            } else {
                locationDisplay.innerHTML = '<p style="margin: 0; color: #dc3545;">‚ùå Geolocation is not supported by this browser.</p>';
            }
        }
        
        function sendLocationSMS() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    const message = `Emergency Location: https://maps.google.com/maps?q=${lat},${lon}`;
                    const phone = prompt('Enter emergency contact number:', '+91');
                    if (phone) {
                        showStatusMessage(`Location SMS prepared for ${phone}`, 'success');
                        alert(`SMS ready to send to ${phone}:\n\n${message}\n\n(In real app, SMS would be sent automatically)`);
                    }
                }, function() {
                    showStatusMessage('Location access required for SMS', 'error');
                });
            }
        }

        // Initialize language selector event listener
        document.addEventListener('DOMContentLoaded', function() {
            const languageSelect = document.getElementById('languageSelect');
            if (languageSelect) {
                languageSelect.addEventListener('change', function() {
                    changeLanguage(this.value);
                });
                
                // Set default language
                changeLanguage('en');
                console.log('Language selector initialized');
            }
        });

        console.log('Nabha Telemedicine MVP loaded successfully!');
    </script>
</body>
</html>